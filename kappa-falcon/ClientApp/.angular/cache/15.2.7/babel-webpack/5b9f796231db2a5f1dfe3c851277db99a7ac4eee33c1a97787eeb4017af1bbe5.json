{"ast":null,"code":"var Buffer = require(\"buffer\").Buffer;\nvar ENETModule = require(\"../build/enet.js\");\nvar enet = require(\"../index.js\");\nvar jsapi_ = ENETModule.jsapi;\nvar enet_ = ENETModule.libenet;\nmodule.exports.Packet = Packet;\nfunction Packet() {\n  var packet = this;\n  var buf, flags;\n\n  //packet from pointer\n  if (arguments.length === 1 && typeof arguments[0] === 'number') {\n    packet._pointer = arguments[0];\n    return packet;\n  }\n\n  //packet from buffer\n  if (arguments.length > 0 && typeof arguments[0] === 'object') {\n    //construct a new packet from node buffer\n    buf = arguments[0];\n    if (typeof arguments[1] === 'number') {\n      flags = arguments[1];\n    }\n    flags = flags || 0; //defaults to unreliable packet\n\n    packet._packetFromBuffer(buf, flags);\n    return packet;\n  }\n\n  //packet from string\n  if (arguments.length > 0 && typeof arguments[0] == 'string') {\n    return new Packet(new Buffer(arguments[0]), arguments[1]);\n  }\n}\nPacket.prototype._packetFromBuffer = function (buf, flags) {\n  var packet = this,\n    begin,\n    end,\n    c,\n    i;\n  packet._pointer = enet_.packet_create(0, buf.length, flags);\n  if (!packet._pointer) return; //no memory allocated for packet\n  begin = jsapi_.packet_get_data(packet._pointer);\n  end = begin + buf.length;\n  c = 0;\n  i = begin;\n  for (; i < end; i++, c++) {\n    ENETModule[\"HEAPU8\"][i] = buf.readUInt8(c);\n  }\n};\nPacket.prototype._attachFreeCallback = function (free_ptr) {\n  jsapi_.packet_set_free_callback(this._pointer, free_ptr);\n};\nPacket.prototype.flags = function () {\n  if (!this._pointer) return 0;\n  return jsapi_.packet_flags(this._pointer);\n};\nPacket.prototype.wasSent = function () {\n  return (this.flags() & enet.PACKET_FLAG.SENT) == enet.PACKET_FLAG.SENT;\n};\nPacket.prototype.data = function () {\n  var begin, end;\n  if (!this._pointer) return undefined;\n  begin = jsapi_.packet_get_data(this._pointer);\n  end = begin + jsapi_.packet_get_dataLength(this._pointer);\n  return new Buffer(ENETModule[\"HEAPU8\"].subarray(begin, end), \"byte\");\n  //return HEAPU8.subarray(begin,end);\n};\n\nPacket.prototype.dataLength = function () {\n  if (!this._pointer) return 0;\n  return jsapi_.packet_get_dataLength(this._pointer);\n};\nPacket.prototype.destroy = function () {\n  if (!this._pointer) return;\n  enet_.packet_destroy(this._pointer);\n  this._pointer = 0;\n};","map":{"version":3,"names":["Buffer","require","ENETModule","enet","jsapi_","jsapi","enet_","libenet","module","exports","Packet","packet","buf","flags","arguments","length","_pointer","_packetFromBuffer","prototype","begin","end","c","i","packet_create","packet_get_data","readUInt8","_attachFreeCallback","free_ptr","packet_set_free_callback","packet_flags","wasSent","PACKET_FLAG","SENT","data","undefined","packet_get_dataLength","subarray","dataLength","destroy","packet_destroy"],"sources":["/Users/jaredcortez/node_modules/enet/lib/Packet.js"],"sourcesContent":["var Buffer = require(\"buffer\").Buffer;\nvar ENETModule = require(\"../build/enet.js\");\nvar enet = require(\"../index.js\");\n\nvar jsapi_ = ENETModule.jsapi;\nvar enet_ = ENETModule.libenet;\n\nmodule.exports.Packet = Packet;\n\nfunction Packet() {\n\tvar packet = this;\n\n\tvar buf, flags;\n\n\t//packet from pointer\n\tif (arguments.length === 1 && typeof arguments[0] === 'number') {\n\t\tpacket._pointer = arguments[0];\n\t\treturn packet;\n\t}\n\n\t//packet from buffer\n\tif (arguments.length > 0 && typeof arguments[0] === 'object') {\n\t\t//construct a new packet from node buffer\n\t\tbuf = arguments[0];\n\n\t\tif (typeof arguments[1] === 'number') {\n\t\t\tflags = arguments[1];\n\t\t}\n\n\t\tflags = flags || 0; //defaults to unreliable packet\n\n\t\tpacket._packetFromBuffer(buf, flags);\n\n\t\treturn packet;\n\t}\n\n\t//packet from string\n\tif (arguments.length > 0 && typeof arguments[0] == 'string') {\n\t\treturn new Packet(new Buffer(arguments[0]), arguments[1]);\n\t}\n}\n\nPacket.prototype._packetFromBuffer = function (buf, flags) {\n\tvar packet = this,\n\t\tbegin, end, c, i;\n\tpacket._pointer = enet_.packet_create(0, buf.length, flags);\n\tif (!packet._pointer) return; //no memory allocated for packet\n\tbegin = jsapi_.packet_get_data(packet._pointer);\n\tend = begin + buf.length;\n\tc = 0;\n\ti = begin;\n\tfor (; i < end; i++, c++) {\n\t\tENETModule[\"HEAPU8\"][i] = buf.readUInt8(c);\n\t}\n};\n\nPacket.prototype._attachFreeCallback = function (free_ptr) {\n\tjsapi_.packet_set_free_callback(this._pointer, free_ptr);\n};\n\nPacket.prototype.flags = function () {\n\tif (!this._pointer) return 0;\n\treturn jsapi_.packet_flags(this._pointer);\n};\n\nPacket.prototype.wasSent = function () {\n\treturn ((this.flags() & enet.PACKET_FLAG.SENT) == enet.PACKET_FLAG.SENT);\n};\n\nPacket.prototype.data = function () {\n\tvar begin, end;\n\tif (!this._pointer) return undefined;\n\tbegin = jsapi_.packet_get_data(this._pointer);\n\tend = begin + jsapi_.packet_get_dataLength(this._pointer);\n\treturn new Buffer(ENETModule[\"HEAPU8\"].subarray(begin, end), \"byte\");\n\t//return HEAPU8.subarray(begin,end);\n};\n\nPacket.prototype.dataLength = function () {\n\tif (!this._pointer) return 0;\n\treturn jsapi_.packet_get_dataLength(this._pointer);\n};\n\nPacket.prototype.destroy = function () {\n\tif (!this._pointer) return;\n\tenet_.packet_destroy(this._pointer);\n\tthis._pointer = 0;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}